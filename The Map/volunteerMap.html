<html>

    <head>
        <title>Volunteer Map</title>
        <style type="text/css">
            html { height: 100% }
            body { height: 100%; margin: 0; padding: 0 }
            #map_canvas { height: 100% }
        </style>


        <script
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDHDjKeI9KGKUePNttGJZVx2kPpWhPcP8s&callback=initMap&libraries=&v=weekly"
            defer
        ></script>


        <script type="text/javascript">

            var eventData = [
                // [Event Title, Event Description, Direct Link to Volunteer, Org Title, Org Main Website, Latitude, Longitude]
                ["Feeding the Old People", "Spoon the cocunut", "https://seniorvolunteers.org/wp-content/uploads/2019/11/SVS-RSVP-Enrollment-Form.pdf", "Senior Volunteer Services (SVS)", "https://seniorvolunteers.org/", 35.253102, -120.667505],
                ["Eating the Old People", "Spoon the cocunut", "https://seniorvolunteers.org/wp-content/uploads/2019/11/SVS-RSVP-Enrollment-Form.pdf", "Senior Volunteer Services (SVS)", "https://seniorvolunteers.org/", 35.253954, -120.695727],
                ["Drinking the Old People", "Spoon the cocunut", "https://seniorvolunteers.org/wp-content/uploads/2019/11/SVS-RSVP-Enrollment-Form.pdf", "Senior Volunteer Services (SVS)", "https://seniorvolunteers.org/", 35.375388, -120.718043],
                ["Smoothy the Old People", "Spoon the cocunut", "https://seniorvolunteers.org/wp-content/uploads/2019/11/SVS-RSVP-Enrollment-Form.pdf", "Senior Volunteer Services (SVS)", "https://seniorvolunteers.org/", 35.114378, -120.605693]
            ];

            function initialize() {

                var myOptions = {
                    zoom: 12,
                };

                var map = new google.maps.Map(document.getElementById("default"), myOptions);

                setMarkers(map,eventData)
                
                // Center map on current location if allowed
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function (position) {
                        initialLocation = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
                        map.setCenter(initialLocation);
                    });
                }

            }

            function setMarkers(map,eventData){

                var marker, i

                for (i = 0; i < eventData.length; i++) {  
                    // [Event Title, Event Description, Direct Link to Volunteer, Org Title, Org Main Website, Latitude, Longitude]
                    var eventTitle = eventData[i][0]
                    var eventDesc = eventData[i][1]
                    var eventLink = eventData[i][2]
                    var orgTitle = eventData[i][3]
                    var orgMainPage = eventData[i][4]
                    var lat = eventData[i][5]
                    var long = eventData[i][6]

                    var contentStringTest =
                        '<div id="content">' +
                        '<div id="siteNotice">' +
                        "</div>" +
                        // TODO - move the heading into the database/csv file
                        '<h1 id="firstHeading" class="firstHeading">' +
                            eventTitle + 
                        '</h1>' +
                        '<div id="bodyContent">' +
                        "<p><b>Event Description</b>" +
                        " " +
                            eventDesc +
                        "</p>" +
                        '<p><a href=' + 
                            eventLink + 
                        '>Volunteer Now</a></p>' +
                        "</p>" +
                        '<p><b>Organized By </b><a href="https://seniorvolunteers.org/wp-content/uploads/2020/05/RSVP-Volunteer-Opportunities1.pdf">OrgTitle</a></p>' +
                        "</div>" +
                        "</div>";                    

                    latlngset = new google.maps.LatLng(lat, long);

                    var marker = new google.maps.Marker({  
                        map: map,
                        title: orgTitle,
                        position: latlngset  
                    });

                    map.setCenter(marker.getPosition())
               
                    attachSecretMessage(marker, contentStringTest);
                
                }
            }

            // Attaches an info window to a marker with the provided message. When the
            // marker is clicked, the info window will open with the secret message.

            function attachSecretMessage(marker, secretMessage) {
                var infowindow = new google.maps.InfoWindow({
                    content: secretMessage,
                });
                marker.addListener("click", function () {
                    infowindow.open(marker.get("map"), marker);
                });
            }

        </script>

    </head>

    <body onload="initialize()">
        <div id="default" style="width:100%; height:100%"></div>
    </body>

</html>